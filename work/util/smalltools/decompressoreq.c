#include <stdio.h>
#include <stdlib.h>

int tbl[32][32] ={
//mmmmm
//43210                              31  30  29  28  27  26  25  24  23  22  21  20  19  18  17  16  15  14  13  12  11  10   9   8   7  6  5  4  3  2  1  0      
//-----                              --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  --  -  -  -  -  -  -  -
/*00000     C.ADDI4SPN        00*/ {  0,  0, 10,  9,  8,  7, 12, 11,  5,  6,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  1,  4,  3,  2, 0, 0, 1, 0, 0, 1, 1},  // addi rd',x2,mzuimm[9:2]   
/*00001     C.FLD/C.FLW(m)    01*/ { -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,-1,-1,-1,-1,-1, 0, 0},  // illegal in midgetv        
/*00010     C.LW              02*/ {  0,  0,  0,  0,  0,  5, 12, 11, 10,  6,  0,  0,  0,  1,  9,  8,  7,  0,  1,  0,  0,  1,  4,  3,  2, 0, 0, 0, 0, 0, 1, 1},  // lw rd',offset[6:2](rs1')  
/*00011 m   C.ADDI16SP        03*/ { 12, 12, 12,  4,  3,  5,  2,  6,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  1,  0, 0, 0, 1, 0, 0, 1, 1},  // addi x2,x2,nzimm[9:4]     
/*00100 m   C.JR              04*/ {  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 11, 10,  9,  8,  7,  0,  0,  0,  0,  0,  0,  0,  0, 1, 1, 0, 0, 1, 1, 1},  // jalr x0,0(rs1)                  
/*00101     C.FSD             05*/ { -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,-1,-1,-1,-1,-1, 0, 0},  // illegal in midgetv        
/*00110     C.SW              06*/ {  0,  0,  0,  0,  0,  5, 12,  0,  1,  4,  3,  2,  0,  1,  9,  8,  7,  0,  1,  0, 11, 10,  6,  0,  0, 0, 1, 0, 0, 0, 1, 1},  // sw rs2',offset[6:2](rs1') 
/*00111     C.FSW             07*/ { -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,-1,-1,-1,-1,-1, 0, 0},  // illegal in midgetv        
/*01000     C.ADDI/C.NOP      08*/ { 12, 12, 12, 12, 12, 12, 12,  6,  5,  4,  3,  2, 11, 10,  9,  8,  7,  0,  0,  0, 11, 10,  9,  8,  7, 0, 0, 1, 0, 0, 1, 1},  // addi rd,rd,nzimm[5:0]     
/*01001     C.JAL             09*/ { 12,  8, 10,  9,  6,  7,  2, 11,  5,  4,  3, 12, 12, 12, 12, 12, 12, 12, 12, 12,  0,  0,  0,  0,  1, 1, 1, 0, 1, 1, 1, 1},  // jal x1, offset[11:1]       
/*01010     C.LI              0a*/ { 12, 12, 12, 12, 12, 12, 12,  6,  5,  4,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0, 11, 10,  9,  8,  7, 0, 0, 1, 0, 0, 1, 1},  // addi rd,x0,imm[5:0]       
/*01011     C.LUI             0b*/ { 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12,  6,  5,  4,  3,  2, 11, 10,  9,  8,  7, 0, 1, 1, 0, 1, 1, 1},  // lui rd,nzimm[17:12].      
/*01100 m   C.JALR            0c*/ {  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 11, 10,  9,  8,  7,  0,  0,  0,  0,  0,  0,  0,  1, 1, 1, 0, 0, 1, 1, 1},  // jalr x1,0(rs1)                  
/*01101     C.J               0d*/ { 12,  8, 10,  9,  6,  7,  2, 11,  5,  4,  3, 12, 12, 12, 12, 12, 12, 12, 12, 12,  0,  0,  0,  0,  0, 1, 1, 0, 1, 1, 1, 1},  // jal x0, offset[11:1]      
/*01110     C.BEQZ            0e*/ { 12, 12, 12, 12,  6,  5,  2,  0,  0,  0,  0,  0,  0,  1,  9,  8,  7,  0,  0,  0, 11, 10,  4,  3, 12, 1, 1, 0, 0, 0, 1, 1},  // beq rs1',x0,offset[8:1]                  
/*01111     C.BNEZ            0f*/ { 12, 12, 12, 12,  6,  5,  2,  0,  0,  0,  0,  0,  0,  1,  9,  8,  7,  0,  0,  1, 11, 10,  4,  3, 12, 1, 1, 0, 0, 0, 1, 1},  // bne rs1',x0,offset[8:1]                  
/*10000     C.SLLI            10*/ {  0,  0,  0,  0,  0,  0,  0,  6,  5,  4,  3,  2, 11, 10,  9,  8,  7,  0,  0,  1, 11, 10,  9,  8,  7, 0, 0, 1, 0, 0, 1, 1},  // slli rd,rd,shamt[5:0]     
/*10001     C.FLDSP           11*/ { -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,-1,-1,-1,-1,-1, 0, 0},  // illegal in midgetv        
/*10010     C.LWSP            12*/ {  0,  0,  0,  0,  3,  2, 12,  6,  5,  4,  0,  0,  0,  0,  0,  1,  0,  0,  1,  0, 11, 10,  9,  8,  7, 0, 0, 0, 0, 0, 1, 1},  // lw rd,offset[7:2](x2)     
/*10011     C.FLWSP           13*/ { -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,-1,-1,-1,-1,-1, 0, 0},  // illegal in midgetv        
/*10100     C.MV              14*/ {  0,  0,  0,  0,  0,  0,  0,  6,  5,  4,  3,  2,  0,  0,  0,  0,  0,  0,  0,  0, 11, 10,  9,  8,  7, 0, 1, 1, 0, 0, 1, 1},  // add rd,rd,rs2             
/*10101 m   C.ADD             15*/ {  0,  0,  0,  0,  0,  0,  0,  6,  5,  4,  3,  2, 11, 10,  9,  8,  7,  0,  0,  0, 11, 10,  9,  8,  7, 0, 1, 1, 0, 0, 1, 1},  // add rd,rd,rs2                   
/*10110     C.SWSP            16*/ {  0,  0,  0,  0,  8,  7, 12,  6,  5,  4,  3,  2,  0,  0,  0,  1,  0,  0,  1,  0, 11, 10,  9,  0,  0, 0, 1, 0, 0, 0, 1, 1},  // sw rs2,offset[7:2](x2)    
/*10111     C.FSWSP/C.FSDSP(m 17*/ { -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,-1,-1,-1,-1,-1, 0, 0},  // illegal                   
/*11000 m   C.SRLI            18*/ {  0,  0,  0,  0,  0,  0,  0,  6,  5,  4,  3,  2,  0,  1,  9,  8,  7,  1,  0,  1,  0,  1,  9,  8,  7, 0, 0, 1, 0, 0, 1, 1},  // srli rd',rd',shamt[5:0]                               
/*11001 m   C.SRAI            19*/ {  0,  1,  0,  0,  0,  0,  0,  6,  5,  4,  3,  2,  0,  1,  9,  8,  7,  1,  0,  1,  0,  1,  9,  8,  7, 0, 0, 1, 0, 0, 1, 1},  // srai rd',rd',shamt[5:0]   
/*11010 m   C.ANDI            1a*/ { 12, 12, 12, 12, 12, 12, 12,  6,  5,  4,  3,  2,  0,  1,  9,  8,  7,  1,  1,  1,  0,  1,  9,  8,  7, 0, 0, 1, 0, 0, 1, 1},  // andi rd',rd',imm[5:0]     
/*11011 m   C.EBREAK          1b*/ {  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 1, 1, 1, 0, 0, 1, 1},  // ebreak                    
/*11100 m   C.SUB             1c*/ {  0,  1,  0,  0,  0,  0,  0,  0,  1,  4,  3,  2,  0,  1,  9,  8,  7,  0,  0,  0,  0,  1,  9,  8,  7, 0, 1, 1, 0, 0, 1, 1},  // sub rd',rd',rs2'          
/*11101 m   C.XOR             1d*/ {  0,  0,  0,  0,  0,  0,  0,  0,  1,  4,  3,  2,  0,  1,  9,  8,  7,  1,  0,  0,  0,  1,  9,  8,  7, 0, 1, 1, 0, 0, 1, 1},  // xor rd',rd',rs2'          
/*11110 m   C.OR              1e*/ {  0,  0,  0,  0,  0,  0,  0,  0,  1,  4,  3,  2,  0,  1,  9,  8,  7,  1,  1,  0,  0,  1,  9,  8,  7, 0, 1, 1, 0, 0, 1, 1},  // or rd',rd'rs2'            
/*11111 m   C.AND             1f*/ {  0,  0,  0,  0,  0,  0,  0,  0,  1,  4,  3,  2,  0,  1,  9,  8,  7,  1,  1,  1,  0,  1,  9,  8,  7, 0, 1, 1, 0, 0, 1, 1},  // and rd',rd',rs2'          
};

/////////////////////////////////////////////////////////////////////////////
char *maketerm(char *ppp, int a) {
        int i;
        for ( i = 4; i >= 0; i-- ) {
                if ( i != 4 )
                        ppp += sprintf( ppp, "&" );
                if ( (a & (1<<i)) == 0)
                        ppp += sprintf( ppp, "~" );
                ppp += sprintf( ppp, "m[%d]", i );
        }
        return ppp;
}
                        
        
/////////////////////////////////////////////////////////////////////////////
int main( void ) {
        int i,j,k,kseen;
        char linebuff[1000];
        char commentlinebuff[1000];
        char scriptfilelinebuff[1000];
        char wirelinebuff[10000];        
        char *p, *pp, *ppp, *qq;
        int print_wire = 0;
        int print_comment = 0;
        int print_assign = 0;
        int print_scriptfile = 1;
                
        for ( j = 0; j < 32; j++ ) {
                p = linebuff;
//                for ( k = -1; k < 16; k++ ) {
                for ( k = 1; k < 16; k++ ) {
                        if ( k == 0 )
                                continue;
                        kseen = 0;
                        pp = commentlinebuff;
                        qq = scriptfilelinebuff;
                        ppp = wirelinebuff;
                        for ( i = 0; i < 32; i++ ) {
                                //printf ( "%d ", tbl[i][j] );                                
                                if ( tbl[i][j] != k )
                                        continue;
                                if ( !kseen ) {
                                        if ( k == -1 ) {
                                                ppp += sprintf( ppp, "Don't cares in e%d :", 31-j );
                                        } else {
                                                if ( k == 1 ) {
                                                        pp += sprintf( pp, "Contribution of 1 in e%d :", 31-j );
                                                } else {
                                                        pp += sprintf( pp, "Contribution of c[%d] in e%d :", k, 31-j );
                                                }
                                                qq += sprintf( qq, "../obj_dir/chained_f5.bin -s \" e%2.2d_%2.2d = \" ", k, 31-j );
                                                ppp += sprintf( ppp, "wire e%d_%d = ", 31-j, k );
                                        }
                                }
                                pp += sprintf( pp, "%c%d ", kseen ? ',' : ' ', i );
                                qq += sprintf( qq, "%d ", i );
                                ppp += sprintf( ppp, "%c", kseen ? '|' : ' ' );
                                ppp = maketerm(ppp,i);
                                kseen = 1;
                        }
                        if ( kseen ) {
                                ppp += sprintf( ppp, ";\n" );
                                if ( print_wire )
                                        printf( "%s", wirelinebuff );
                                if ( print_comment )
                                        printf( "//%s\n", commentlinebuff );
                                if ( print_scriptfile )
                                        printf( "%s\n", scriptfilelinebuff );
                                if ( k == 1 ) {
                                        p += sprintf( p, "e%d_%d|", 31-j, k);                                        
                                } else {
                                        p += sprintf( p, "e%d_%d&c[%d]|", 31-j, k, k);
                                }
                        }
                }
                *(p-1) = ';';
                if ( print_assign )
                        printf( "assign e[%d] = %s\n", 31-j, linebuff );
        }
        return 0;
}
